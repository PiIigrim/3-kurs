<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0054)http://microsin.net/adminstuff/windows/wmi/Pechat.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru-ru" lang="ru-ru" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	  <!--<base href="http://microsin.net/adminstuff/windows/wmi/Pechat.html">--><base href=".">
  
  <meta name="robots" content="noindex, nofollow">
  <meta name="keywords" content="Windows, WMI">
  
  <meta name="author" content="AJEV">
  <meta name="description" content="Популярное знакомство с инструментарием управления Windows: WMI.">
  
  <title>Не знаете, что такое WMI? Тогда мы идем к Вам! | windows | adminstuff</title>
  <script type="text/javascript" src="./Teory_files/mootools.js.Без названия"></script>
  <script type="text/javascript" src="./Teory_files/caption.js.Без названия"></script>
  <script type="text/javascript">
/*<![CDATA[*/
	var jax_live_site = 'http://microsin.net/index.php';
	var jax_site_type = '1.5';
/*]]>*/
</script><script type="text/javascript" src="./Teory_files/ajax_1.0.js.Без названия"></script>
  <link rel="stylesheet" type="text/css" href="./Teory_files/style.css">
<link rel="stylesheet" type="text/css" href="./Teory_files/comment_style.css">

<script type="text/javascript">
/*<![CDATA[*/
var jc_option           = "";
var jc_autoUpdate       = "0";
var jc_update_period    = 300*1000;
var jc_orderBy          = "1";
var jc_livesite_busyImg = "http://microsin.net/components/com_jomcomment/busy.gif";
var jc_username         = "";
var jc_email            = "";
var jc_commentForm;
/*]]>*/
</script>

	<link rel="stylesheet" href="./Teory_files/general.css" type="text/css">
		<link rel="stylesheet" href="./Teory_files/template.css" type="text/css">
<meta http-equiv="Content-Language" content="en"></head>
<body class="contentpane">
	
	<table class="contentpaneopen">
<tbody><tr>
		<td class="contentheading" width="100%">
					Не знаете, что такое WMI? Тогда мы идем к Вам!			</td>
				<td align="right" width="100%" class="buttonheading">
		<a href="http://microsin.net/adminstuff/windows/wmi/Pechat.html#" onclick="window.print();return false;"><img src="./Teory_files/printButton.png" alt="Печать"></a>		</td>
	</tr>
</tbody></table>

<table class="contentpaneopen">
<tbody><tr>
	<td valign="top">
		<span class="small">
			Добавил(а) AJEV		</span>
		&nbsp;&nbsp;
	</td>
</tr>



<tr>
<td valign="top">
<div class="Section1">
<p class="MsoNormal">Хороший материал, взятый из журнала samag.ru [14], автор Константин Леонтьев. Тем, кто его до сих пор не читает, читать немедленно...</p>
</div>



<p>[<strong>Вы всё ещё не используете WMI?</strong>]</p>
<table border="0">
<tbody>
<tr>
<td style="width: 200px;"></td>
<td>
<p style="text-align: left;" align="right"><em>Если ты один из большинства админов, ты частенько грустишь, выглядывая из окна и наблюдая, как некоторые твои собратья ездят на своих «Ягуарах» и «Порше», или готовятся дернуть в Монте-Карло или какое-нибудь другое экзотическое место. И, конечно же, ты говоришь себе: "Я знаю о системном администрировании столько же, сколько и они, но почему именно у них есть клёвые тачки, яхты и часы «Ролекс»?..". Что ж, мы здесь для того, чтобы приоткрыть тебе небольшой секрет. Это все потому, что они знают, как писать WMI-скрипты, а ты – нет!</em></p>
<p style="text-align: left;" align="right">Microsoft TechNet: Bob Wells, Dean Tsaltas, Ethan Wilansky и Greg Stemp</p>
</td>
</tr>
</tbody>
</table>
<p style="text-align: left;" align="right">Начиная карьеру системного администратора, Вы вероятно и не задумывались о том, что вместе с Вашим профессиональным ростом будет расти размер и сложность обслуживаемых систем. И вот наступил момент, когда вы поняли, что нужно принципиально новое решение, для того чтобы справляться с огромным количеством рутины, да ещё и в разных офисах вашей компании. Вероятнее всего, Вы уже немного знакомы с WMI на практике и используете некоторые готовые сценарии WMI для решения повседневных задач. Но согласитесь, что эффективное использование технологии начинается только тогда, когда вы понимаете ее архитектуру и четко представляете весь спектр возможностей, которые эта технология может вам предоставить.</p>
<p>Основная моя цель – кратко изложить основы, необходимые для эффективного использования вами этой технологии и представить вам набор рецептов по ее применению в реальных условиях.</p>
<p>Вы получите практический навык работы со всеми основными средствами WMI, выполнив несколько простых, но весьма полезных упражнений. Я предполагаю, что вы немного знакомы с программированием на VBScript и с азами языка SQL, а также имеете общее представление об объектно-ориентированном программировании. Обратите внимание на готовые примеры кода, которые помогут вам в Вашей работе.</p>
<p><strong>Что такое WMI?</strong></p>
<p>Формально: аббревиатура WMI – это Windows Management Instrumentation (инструментарий управления Windows). Из названия понятно, для чего создана и применяется эта технология. Стоит лишь добавить, что она давно перешагнула рамки управления только операционной системой Windows и позволяет контролировать множество других совместимых с ней приложений.</p>
<p>По своей сути WMI – это расширенная и адаптированная компанией Microsoft реализация стандарта WBEM (WebBased Enterprise Management компании DMTF Inc [1]). В основе WBEM лежит идея создания универсального интерфейса мониторинга и управления к различным системам и компонентам распределенной информационной среды предприятия с использованием объектно-ориентированной идеологии и широко распространенных веб-технологий представления информации: протоколов XML и HTTP. Стандарт WBEM является правопреемником стандарта DMI (Desktop Management Interface).</p>
<p>В основе структуры представления данных в стандарте WBEM лежит CIM (Common Information Model – модель информации общего типа), реализующая объектно-ориентированный подход к представлению компонентов систем как классов со своим набором свойств и методов, а также принципов наследования.</p>
<p>Основное средство для описания новых элементов модели CIM – это синтаксис языка Managed Object Format (MOF), который является текстовым и легко понятным человеку. Таким образом, любое приложение или драйвер в операционной системе, которая поддерживает стандарт WBEM, может добавить к системной модели CIM свой набор классов. Такое расширение модели CIM позволяет легко интегрировать в единую систему мониторинга и управления все новые и новые приложения. Для этой интеграции приложение должно лишь зарегистрировать свои классы в существующей модели CIM и обеспечить стандартные вызовы встроенных процедур для создания объектов этих классов и наполнения их свойствами и методами. Набор этих процедур оформляется, как WMI Provider – специальная библиотека, являющаяся мостом между любым приложением и ядром службы WMI.</p>
<p>Таким образом, WMI – это открытая унифицированная библиотека (репозиторий) однотипных интерфейсов доступа к параметрам, настройки и свойствам различных систем и их компонентов. Архитектура WMI представлена на рис. 1.</p>
<p><img src="./Teory_files/WMI-architecture.gif" alt="WMI-architecture" width="697" height="583"></p>
<p>Рисунок 1. Архитектура WMI</p>
<p>Многие производители программного и аппаратного обеспечения ведут разработку ПО в соответствии со стандартом WBEM. Как следствие, это ПО совместимо и с WMI, а значит, может управляться через единый и удобный интерфейс.</p>
<p><strong>Классы, объекты, свойства и методы</strong></p>
<p>Поскольку WMI построена по объектно-ориентированному принципу, то все данные об операционной системе, ее свойствах, управляемых приложениях и обнаруженном оборудовании представлены в виде объектов. Каждый тип объекта описан классом, в состав которого входят свойства и методы. Определения классов описаны в MOF-файлах, а объекты этих классов с заполненными свойствами и доступными методами при их вызове возвращаются WMI-провайдерами. Управляет созданием и удалением объектов, а также вызовом их методов служба CIM Object Manager.</p>
<p>Получается, что если мы хотим управлять настройками сетевого адаптера, то мы должны запросить у CIM Object Manager экземпляр объекта нужного нам сетевого адаптера (забегая вперед, скажу, что этот объект принадлежит классу Win32_NetworkAdapterConfiguration) и вызвать нужные нам методы. В частности, для того чтобы обновить аренду адреса на DHCP сервере, достаточно вызвать метод RenewDHCPLease экземпляра объекта Win32_NetworkAdapterConfiguration.</p>
<p><strong>Обзор средств работы с WMI для администратора</strong></p>
<p>Начнем фактическое знакомство с WMI с обзора утилит, которые позволяют вам работать с WMI на ОС семейства Windows. Условно разделим этот набор утилит на поставляемые с операционной системой по умолчанию и набор утилит, которые потребуется скачивать с сайта компании Microsoft. К первой категории относятся следующие утилиты:</p>
<p>• <strong>wmimgmt.msc</strong> – оснастка консоли MMC, позволяющая в целом управлять самой системой WMI на выбранном компьютере.<br>• <strong>Winmgmt.exe</strong> – консольная утилита управления WMI. Выполняет аналогичные действия, что и консоль MMC wmimgmt.msc. Кроме того, является исполняемым файлом сервиса WMI в системе. Для запуска из консоли используется с опцией /exe (winmgmt.exe /exe).<br>• <strong>Wbemtest.exe</strong> – графическая утилита для интерактивной работы с WMI. Удобна для тестирования классов и методов, просмотра свойств и т. п.<br>• <strong>Wmic.exe</strong> – консольная утилита для вызова объектов и методов WMI (WMI Console) – присутствует только в Windows XP и Windows Server 2003.<br>• <strong>mofcomp.exe</strong> – компилятор MOF-файлов. Служит для расширения репозитория WMI и тонких операций с библиотекой классов WMI, а также для «ремонта» нарушенного репозитория.</p>
<p>Ко второй категории средств для работы с WMI, которые требуется дополнительно устанавливать, относится:</p>
<p>• <strong>WMI Code Creator 1.0</strong> – очень удобная и полезная утилита для создания готовых сценариев WMI. Поддерживает языки Visual Basic Script, C# и Visual Basic .NET [2].<br>• <strong>WMI Administrative Tools</strong> – комплект средств в составе: WMI CIM Studio, WMI Event Registration, WMI Event Viewer и WMI Object Browser). Удобная среда разработки и тестирования WMI-классов и методов [3].<br>• <strong>Scriptomatic 2.0</strong> – мастер в формате Hyper Text Application (HTA). Удобна для создания готовых сценариев и на различных скриптовых языках. Поддерживает Visual Basic Script, Perl, Java Script и Python [4].<br>• <strong>Tweakomatic Utility</strong> – утилита в формате Hyper Text Application (HTA). Содержит множество настроек системы, обычно доступных через утилиты-твикеры (например, Windows XP Power Toys TweakUI), для которых позволяет сгенерировать WMI-скрипты для их автоматической настройки. Весьма полезна при разработке сценариев автоматизированной установки и настройки [5].</p>
<p>Все утилиты, относящиеся ко второй категории, можно бесплатно скачать с сайта компании Microsoft по ссылкам, перечисленным в конце статьи. Полезно будет так же посетить раздел загрузки средств работы со скриптами [6] и общий раздел загрузки средств работы с WMI [7].</p>
<p>Для того, чтобы рассмотреть возможности и особенности всех средств работы с WMI, которые перечислены выше, не хватит и целого журнала, поэтому мы кратко остановимся на некоторых из них, на мой взгляд, наиболее полезных и (или) наиболее употребимых. Собственно, к таким я отношу следующие утилиты: WBEMTEST, WMIC, WMI Administrative Tools и довольно новую, но весьма полезную и удачную утилиту WMI Code Creator 1.0.</p>
<p>Надо отметить, что существуют и другие утилиты и средства работы с WMI, в том числе разработанные не компанией Microsoft, однако формат статьи не позволяет нам на них останавливаться сколько-нибудь подробно. Об одном из этих средств я считаю своим долгом хотя бы упомянуть в этой статье – это ADSI Scriptomatic [8], позволяющее создавать скрипты для управления службой каталогов Microsoft Active Directory.</p>
<p>Все примеры в этой статье протестированы на операционной системе Windows XP Service Pack 2, однако должны также корректно работать и на более ранних версиях OS Windows вплоть до Windows 2000. Если вам потребуется использовать WMI на более ранних версиях ОС Windows, то вам необходимо будет установить WMI Core Components 1.5 [9] и последнюю версию Windows Scripting Host [10, 11] на эти ОС.</p>
<p><strong>Знакомимся с утилитой WBEMTEST</strong></p>
<p class="MsoNormal">Чтобы прямо сейчас посмотреть, какой набор классов определен в репозитории WMI на вашем персональном компьютере, достаточно запустить утилиту wbemtest.exe и установить флажок «Enable All Privileges», как показано на рис. 2.</p>
<p><img src="./Teory_files/WMI-WBEMTEST-pic02-main-window.gif" alt="WMI-WBEMTEST-pic02-main-window" width="456" height="389"></p>
<p>Рисунок 2. Основное окно утилиты WBEMTEST</p>
<p>Далее нужно нажать кнопку «Connect…», в поле пространства имен вписать root\CIMv2, как это показано на рис. 3, и нажать кнопку «Connect».</p>
<p><img src="./Teory_files/WMI-WBEMTEST-pic03.gif" alt="WMI-WBEMTEST-pic03" width="396" height="450"></p>
<p>Рисунок 3. Окно настройки подключения к репозиторию WMI утилиты WBEMTEST</p>
<p><img style="text-indent: 18.933332443237305px;" src="./Teory_files/WMI-WBEMTEST-pic04.gif" alt="WMI-WBEMTEST-pic04" width="456" height="389"></p>
<p>Рисунок 4. Основное окно утилиты WBEMTEST после подключения к репозиторию WMI</p>
<p>Затем нажмите кнопку «Enum Classes…», выберите «Recursive», не заполняйте поле суперкласса и нажмите «Ok». В результате вы получите список классов, определенный в вашем репозитории WMI, в пространстве имен CIMv2. Найдите среди всех класс с названием Win32_OperatingSystem (CIM_OperatingSystem), как это показано на рис. 5.</p>
<p><img src="./Teory_files/WMI-WBEMTEST-pic05.gif" alt="WMI-WBEMTEST-pic05" width="482" height="319"></p>
<p>Рисунок 5. Окно результатов запроса со списком всех классов WMI пространства имен CIMv2</p>
<p>Дважды щелкните курсором мыши по классу Win32_OperatingSystem, посмотрите его свойства. Пример того, как это выглядит, показан на рис. 6.</p>
<p><img src="./Teory_files/WMI-WBEMTEST-pic06.gif" alt="WMI-WBEMTEST-pic06" width="483" height="455"></p>
<p>Рисунок 6. Окно свойств класса Win32_OperatingSystem</p>
<p>Далее нужно нажать кнопку «Instances» и в открывшемся окне дважды щелкнуть курсором мыши по строке в списке экземпляров операционных систем. В открывшемся окне свойств экземпляра операционной системы найдите свойство («Property») с названием «Name», как это показано на рис. 7.</p>
<p><img src="./Teory_files/WMI-WBEMTEST-pic07.gif" alt="WMI-WBEMTEST-pic07" width="483" height="455"></p>
<p>Рисунок 7. Окно свойств экземпляра объекта класса Win32_OperatingSystem</p>
<p>Дважды кликните по свойству курсором мыши. В открывшемся окне редактора свойств, которое показано на рис. 8, скопируйте отображаемое значение в буфер обмена. Оно пригодится нам в дальнейшем.</p>
<p><img src="./Teory_files/WMI-WBEMTEST-pic08.gif" alt="WMI-WBEMTEST-pic08" width="482" height="385"></p>
<p>Рисунок 8. Окно со значением свойства Name экземпляра объекта класса Win32_OperatingSystem</p>
<p>Далее закройте все окна, кроме основного окна программы wbemtest. В блокноте отредактируйте строку из буфера обмена следующем образом:</p>
<p>- Заключите строку в кавычки.<br>- До первых кавычек добавьте следующий текст: «Win32_Operating-System.Name=».<br>- Замените все одинарные обратные слеши на двойные.</p>
<p>В итоге у вас должна получиться примерно следующая строка (в зависимости от версии ОС и логического диска, куда она установлена):</p>
<p class="MsoNormal" style="margin-left: 5.65pt; text-indent: 8.5pt;"><strong><span style="font-size: 8pt; font-family: &#39;Courier New&#39;;">Win32_OperatingSystem.Name="Microsoft Windows XP Professional|C:\\WINDOWS|\\Device\\Harddisk0\\Partition1"</span></strong></p>
<p>Теперь давайте выполним следующее упражнение с утилитой wbemtest. В уже открытом окне утилиты wbemtest нажмем кнопку «Execute Method…» и в окошко «GetObjectPath» вставим строку, которую мы подготовили в блокноте. В появившемся окне (см. рис. 9) вызова метода экземпляра объекта выберите метод Reboot и нажмите кнопку «Execute!».</p>
<p><img src="./Teory_files/WMI-WBEMTEST-pic09.gif" alt="WMI-WBEMTEST-pic09" width="434" height="169"></p>
<p>Рисунок 9. Окно вызова метода для экземпляра объекта класса Win32_OperatingSystem утилиты WBEMTEST</p>
<p>Поздравляю, Вы только что отправили свою операционную систему в перезагрузку, используя WMI. Если вы вдруг получили вместо перезагрузки сообщение об ошибке 0x80041062 «Privilege not held», то это означает, что вы забыли установить опцию «Enable All Privileges» до подключения к репозиторию WMI.</p>
<p>Теперь следует сказать (пока Windows перезагружается), что при подключении к пространству имен WMI вы можете подключаться не только на локальной машине, но и как следует из обзора WMI к любой удаленной. Главное, обладать на той машине необходимыми правами. Но об этих правах позднее! Для подключения к удаленной машине в окне подключения достаточно в поле Name Space указать строку вида \\\root\CIMv2 и указать учетные данные пользователя, обладающего необходимыми правами (например, Administrator). Пример этого показан на рис. 10.</p>
<p><img src="./Teory_files/WMI-WBEMTEST-pic10.gif" alt="WMI-WBEMTEST-pic10" width="396" height="450"></p>
<p>Рисунок 10. Окно подключение к пространству имен WMI с явным указанием имени сервера</p>
<p>Не пробуйте подключаться к локальной машине, на которой запрашиваются объекты и методы WMI (например, на той, на которой сейчас выполняется утилита wbemtest), используя отличные от текущих учетные данные – все равно это у вас не получится. Это специальная защита для повышения локальной безопасности WMI, но о ней мы поговорим позже.</p>
<p><strong>Утилита WMIC</strong></p>
<p>Чтобы воспользоваться этой очень важной и полезной для администратора утилитой, достаточно запустить интерпретатор командной строки cmd.exe и в строке приглашения набрать WMIC. После этого у вас появится приглашение консоли WMI, как это показано на рис. 11.</p>
<p><a href="./Teory_files/WMI-WMIC.gif"><img src="./Teory_files/WMI-WMIC.gif" alt="WMI-WMIC" width="400" height="222"></a></p>
<p>Рисунок 11. Командное окно с запущенной утилитой WMIC в интерактивном режиме</p>
<p>Для получения справки по всем командам, доступным из консоли WMIC, достаточно в строке приглашения ввести команду «/?». Синтаксис каждой команды или глобальной опции вы можете посмотреть, введя ее название и знак вопроса. Например:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">process list /?
</pre>
</div>
<p>Так мы работаем с утилитой WMIC в интерактивном режиме. Однако ничто не мешает нам использовать ее и в пакетном режиме из наших BAT/CMD-сценариев. Например, в приглашении командной строки CMD можно написать:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic process list /?
</pre>
</div>
<p>и получить тот же результат.</p>
<p>Утилита WMIC создана для удобства использования WMI прямо из командной строки, поэтому наиболее употребимые классы WMI доступны для использования под псевдонимами (ALIAS). Вы можете самостоятельно определить псевдонимы для тех классов, для которых это еще не сделано, или добавить новые псевдонимы для тех классов WMI, которые уже их имеют.</p>
<p>Список псевдонимов, которые определены на Windows XP Service Pack 2 по умолчанию с их кратким описанием, приведены в таблице 1.</p>
<p>Таблица 1. Список псевдонимов утилиты WMIC и соответствие их классам WMI</p>
<table style="border-collapse: collapse;" border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td style="background-color: #d8d8f4; border: 1pt solid black; text-align: center; background-position: initial initial; background-repeat: initial initial;"><strong>Псевдоним</strong></td>
<td style="border-right-color: black; border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-top-color: black; background-color: #d8d8f4; border-bottom-color: black; text-align: center; background-position: initial initial; background-repeat: initial initial;"><strong>Описание</strong></td>
<td style="border-right-color: black; border-width: 1pt 1pt 1pt medium; border-style: solid solid solid none; border-top-color: black; background-color: #d8d8f4; border-bottom-color: black; text-align: center; background-position: initial initial; background-repeat: initial initial;"><strong>Имя класса WMI</strong></td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">BASEBOARD</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление материнской платой, она также называется motherboard, или системная плата.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_BIOS</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">BIOS</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управления базовыми сервисами ввода/вывода (Basic input/output services, BIOS).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_BaseBoard</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">BOOTCONFIG</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление конфигурацией загрузки (Boot configuration management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_BootConfiguration</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">CDROM</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление приводом CD-ROM.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_CDROMDrive</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">COMPUTERSYSTEM</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление системой компьютера.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_ComputerSystem</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">CPU</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление процессовром.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">WIN32_PROCESSOR</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">CSPRODUCT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Получение от SMBIOS информации о компьютере как системном продукте.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_ComputerSystemProduct</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">DATAFILE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление данными файлов (DataFile Management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">CIM_DataFile</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">DCOMAPP</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление приложениями (DCOM Application management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">WIN32_DCOMApplication</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">DESKTOP</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление рабочим столом пользователя (User’s Desktop management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">WIN32_DESKTOP</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">DESKTOPMONITOR</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Desktop Monitor management</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">WIN32_DESKTOPMONITOR</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">DEVICEMEMORYADDRESS</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление адресами памяти устройств (Device memory addresses management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_DeviceMemoryAddress</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">DISKDRIVE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление диском на физическом уровне (Physical disk drive management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_DiskDrive</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">DISKQUOTA</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление квотами NTFS пространства диска (Disk space usage for NTFS volumes).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_DiskQuota</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">DMACHANNEL</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление каналами прямого доступа к памяти (Direct memory access, DMA channel management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_DMAChannel</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">ENVIRONMENT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление настройками системного окружения (System environment settings management)</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_Environment</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">FSDIR</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление директориями файловой системы (Filesystem directory entry management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_Directory</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">GROUP</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление группами учетных записей (Group account management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_Group</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">IDECONTROLLER</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление контролером диска IDE (IDE Controller management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_IDEController</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">IRQ</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление сигналами прерываний (Interrupt request line, IRQ management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_IRQResource</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">JOB</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Предоставляет доступ к назначенным заданиям (jobs scheduled) с использованием службы назначенных заданий (schedule service).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_ScheduledJob</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">LOADORDER</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление службами системы, которые задают зависимости запуска (execution dependencies).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_LoadOrderGroup</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">LOGICALDISK</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление дисковыми локальными устройствами хранения (Local storage device management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_LogicalDisk</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">LOGON</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление сессиями пользователей (LOGON Sessions).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_LogonSession</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">MEMCACHE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление кэшем (Cache memory management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">WIN32_CACHEMEMORY</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">MEMLOGICAL</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление памятью системы (как сконфигурирована карта памяти, и как память доступна для приложений и сервисов).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_LogicalMemoryConfiguration</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">MEMPHYSICAL</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление памятью компьютера на физическом уровне (Computer system’s physical memory management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_PhysicalMemoryArray</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">NETCLIENT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление клиентом сети (Network Client management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">WIN32_NetworkClient</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">NETLOGIN</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление информацией учетной записи сети для отдельного пользователя.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_NetworkLoginProfile</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">NETPROTOCOL</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление протоколами и их сетевыми характеристиками.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_NetworkProtocol</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">NETUSE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление активным сетевым соединением.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_NetworkConnection</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">NIC</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление сетевым адаптером (Network Interface Controller, NIC).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_NetworkAdapter</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">NICCONFIG</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление конфигурацией сетевого адаптера.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_NetworkAdapterConfiguration</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">NTDOMAIN</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление доменом NT.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_NTDomain</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">NTEVENT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Получение доступа к логам событий (Entries in the NT Event Log).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_NTLogEvent</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">NTEVENTLOG</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление файлом лога (NT eventlog file management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_NTEventlogFile</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">ONBOARDDEVICE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление общими адаптерами, установленными в материнскую плату (system board).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_OnBoardDevice</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">OS</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление инсталлированными операционными системами.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_OperatingSystem</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">PAGEFILE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление виртуальной памятью и её свопом на диск.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_PageFileUsage</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">PAGEFILESET</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Установка параметров файла свопа.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_PageFileSetting</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">PARTITION</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление логическими разделами физического диска (Management of partitioned areas of a physical disk).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_DiskPartition</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">PORT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление портами ввода/вывода (I/O port management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_PortResource</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">PORTCONNECTOR</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление физическим соединением портов (Physical connection ports management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_PortConnector</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">PRINTER</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Printer device management</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_Printer</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">PRINTERCONFIG</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление конфигурацией принтера.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_PrinterConfiguration</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">PRINTJOB</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление заданиями принтера.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_PrintJob</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">PROCESS</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление процессами.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_Process</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">PRODUCT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление задачей инсталляционных пакетов (Installation package task management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_Product</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">QFE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Быстрое исправление ошибок (Quick Fix Engineering).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_QuickFixEngineering</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">QUOTASETTING</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Установка информации о квотах, установленных для тома диска (Setting information for disk quotas on a volume).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_QuotaSetting</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">RECOVEROS</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Информация, которая была захвачена из памяти при крахе системы.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_OSRecoveryConfiguration</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">REGISTRY</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление реестром системы.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_Registry</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">SCSICONTROLLER</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление контроллером SCSI.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_SCSIController</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">SERVER</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление информацией о сервере.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_PerfRawData_PerfNet_Server</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">SERVICE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление прикладными сервисами.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_Service</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">SHARE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление общими сетевыми ресурсами (Shared resource management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_Share</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">SOFTWAREELEMENT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление элементами программных продуктов, установленных в системе.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_SoftwareElement</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">SOFTWAREFEATURE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление подмножествами программных продуктов SoftwareElement.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_SoftwareFeature</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">SOUNDDEV</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление устройством звука.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">WIN32_SoundDevice</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">STARTUP</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление командами автозапуска при входе пользователя в систему.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_StartupCommand</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">SYSACCOUNT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление учетной записью системы (System account management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_SystemAccount</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">SYSDRIVER</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление системным драйвером для базовой службы (Management of the system driver for a base service).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_SystemDriver</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">SYSTEMENCLOSURE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление физическим доступом к корпусу компьютера (Physical system enclosure management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_SystemEnclosure</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">SYSTEMSLOT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление физичесими соединениями, включая порты, слоты и периферийные устройства, и точками проприетарных соединений.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_SystemSlot</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">TAPEDRIVE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление накопителем на магнитной ленте.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_TapeDrive</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">TEMPERATURE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление данными от датчика температуры (электронный термометр).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_TemperatureProbe</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">TIMEZONE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление данными часового пояса (Time zone data management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_TimeZone</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">UPS</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление источником бесперебойного питания (Uninterruptible power supply, UPS).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_UninterruptiblePowerSupply</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">USERACCOUNT</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Управление учетными записями пользователей (User account management).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_UserAccount</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">VOLTAGE</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управление данными сенсора напряжения (электронный вольтметр).</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_VoltageProbe</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: 1pt solid; border-bottom: 1pt solid;">VOLUMEQUOTASETTING</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Связывает установки дисковой квоты с определенным дисковым томом.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #fff7f7; border-left: medium none; border-bottom: 1pt solid;">Win32_VolumeQuotaSetting</td>
</tr>
<tr>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: 1pt solid; border-bottom: 1pt solid;">WMISET</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Управляет рабочими параметрами службы WMI.</td>
<td style="border-right: 1pt solid; border-top: medium none; background: #f4f4fc; border-left: medium none; border-bottom: 1pt solid;">Win32_WMISetting</td>
</tr>
</tbody>
</table>
<p>Теперь давайте попробуем использовать утилиту WMIC для работы с WMI из командной строки. Для начала выйдите из интерактивного режима консоли WMIC командой exit. Вы оказались в среде командного интерпретатора CMD. В приглашении наберите команду:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic process list brief
</pre>
</div>
<p>Вы получите список процессов, запущенных на вашем локальном компьютере. Теперь выполните команду:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic process list brief | find "cmd.exe"
</pre>
</div>
<p>Теперь список процессов ограничен только теми процессами, в имени исполняемого модуля которых присутствует строка «cmd.exe». Обратите внимание на PID процесса(ов).</p>
<p>Давайте попробуем отобрать интересующие нас процессы, используя непосредственно WMI и не прибегая к стандартным средствам командной строки. Для этого просто напишите:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic process where description='cmd.exe' list brief
</pre>
</div>
<p>Сравните полученные результаты. Запомните PID процесса CMD.EXE.</p>
<p>Вызовем метод Terminate для экземпляра объекта WMI. Так мы завершим интересующий нас процесс в системе. Для того чтобы однозначно определить процесс, который мы хотим завершить, нам нужно использовать его PID или какой-либо другой набор атрибутов процесса, которые позволяют его однозначно отличить от множества других процессов в системе. Для завершения процесса нам нужно вызвать метод WMI. Для этого существует команда CALL. Для того чтобы вывести справку по всем методам, применимым к объектам типа PROCESS (Win32_Process), наберите команду:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic process call /?
</pre>
</div>
<p>Среди них обратите внимание на метод Terminate – он принимает в качестве единственного входного параметра значение типа UINT32 (беззнаковое 32-разрядное целое) в качестве индекса причины завершения процесса. В данном случае этот параметр аналогичен Exit-коду.</p>
<p>Запустите четыре разных экземпляра процесса cmd.exe (откройте 4 командных окна). Еще раз выполните команду:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic process where description='cmd.exe' list brief
</pre>
</div>
<p>В результате вы получите в ответ примерно следующее:</p>
<p><span style="color: #ffffff;"><span style="color: #ffffff;"><span style="background-color: #000000;"><span style="color: #ffffff;"><span style="font-family: terminal,monaco;"><strong><span style="font-size: 8pt; color: #d6d2d2; font-family: &#39;Courier New&#39;;">HandleCount&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Priority&nbsp;&nbsp;ProcessId&nbsp;&nbsp;ThreadCount&nbsp;&nbsp;WorkingSetSize </span></strong><br> <strong><span style="font-size: 8pt; color: #d6d2d2; font-family: &#39;Courier New&#39;;">28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.exe&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4648&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2494464&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><br> <strong><span style="font-size: 8pt; color: #d6d2d2; font-family: &#39;Courier New&#39;;">28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmd.exe&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5156&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2498560&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong><br> <strong><span style="font-size: 8pt; color: #d6d2d2; font-family: &#39;Courier New&#39;;">28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmd.exe&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4940&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2498560&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong><br> <strong><span style="font-size: 8pt; color: #d6d2d2; font-family: &#39;Courier New&#39;;">31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmd.exe&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 612&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2703360&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong></span></span></span></span></span></p>
<p>Итак, чтобы завершить конкретный процесс, просто наберите:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic process where processid='****' call terminate(0)
</pre>
</div>
<p>вместо звездочек укажите PID нужного вам экземпляра процесса cmd.exe.</p>
<p>Теперь давайте одной командой завершим все оставшиеся процессы cmd.exe, для этого просто введите команду:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic process where description='cmd.exe' call terminate(0)
</pre>
</div>
<p>Что за конструкция where и как еще ее можно использовать, мы разберем чуть позже в разделе «Язык запросов WQL».</p>
<p>Для того чтобы подключиться к репозиторию WMI на другом компьютере и выполнять все те же действия, при условии, что наша учетная запись обладает достаточными правами, нам всего лишь нужно немного модифицировать нашу командную строку. Теперь наши команды должны выглядеть примерно так:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic /NODE:server01 /USER:DOMAIN\Administrator /PASSWORD:qwerty
/PRIVILEGES:ENABLE process where description='cmd.exe' list brief
</pre>
</div>
<p>Если же вы хотите выполнить какие-то действия, используя WMI не с одним, а с целой группой компьютеров, то достаточно написать команду с использованием WMIC и ключом «/node:@serverslist.txt»:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic /NODE:@serverslist.txt /USER:DOMAIN\Administrator /PASSWORD:qwerty
/PRIVILEGES:ENABLE process where description='cmd.exe' list brief
</pre>
</div>
<p>В файле serverlist.txt в столбец или в строку должны быть перечислены имена (IP-адреса) хостов, на которых необходимо выполнить это действие.</p>
<p>В довершение краткого описания утилиты WMIC, следует сказать об еще одной, поистине замечательной, ее особенности – форматировании вывода. Практически все команды WMIC, которые возвращают информацию, могут ее форматировать разными способами. Для этого используется ключ «/format:». Форматирование производится с использованием технологии XSLT (шаблонов для преобразования XML). По умолчанию уже определен ряд готовых преобразований: CSV, HFORM, HMOF, HTABLE, HXML, RAWXML, TABLE, VALUE. Вы так же сами можете определить дополнительные шаблоны форматирования в формате XSLT и использовать их совместно с WMIC.</p>
<p><strong>Краткое практическое знакомство c WMI CIM Studio</strong></p>
<p>Это набор приложений Microsoft Internet Explorer, который позволяет с одной стороны очень тонко, с другой стороны довольно удобно работать с WMI. При этом вы можете как просматривать классы и вызывать методы, так и создавать события и даже модифицировать репозиторий WMI. Поэтому будьте очень осторожны. Если вы запускаете WMI CIM Studio на Windows XP Service Pack 2, то Internet Explorer предупредит вас о потенциальной угрозе безопасности. Вам следует разрешить заблокированное содержимое ActiveX.</p>
<p>На рис. 12 показан вид окна WMI CIM Studio. Слева вы видите набор классов WMI и их иерархии в том пространстве имен WMI, которое вы выбрали при подключении. Справа перечислены все свойства выбранного класса. Все методы класса перечислены на закладке Methods, а на закладке Associations показана «родословная» этого класса и других классов, которые выведены из него.</p>
<p><a href="./Teory_files/WMI-CIM-Studio.gif"><img src="./Teory_files/WMI-CIM-Studio.gif" alt="WMI-CIM-Studio" width="400" height="309"></a></p>
<p>Рисунок 12. Окно утилиты WMI CIM Studio с открытыми свойствами класса Win32_OperatingSystem</p>
<p>Если вы хотите посмотреть все экземпляры объектов выбранного класса, существующие в вашей системе, то достаточно нажать кнопку со значком списка (четвертая справа кнопка в правой панели кнопок).</p>
<p>WMI CIM Studio очень удобный инструмент для поиска классов и свойств в огромном море репозитория WMI. Для поиска нажмите кнопку со значком бинокля и введите шаблон для поиска, например «network». Выберите область поиска (Class names, Class description, Property names) и нажмите «Go!». В целом WMI CIM Studio очень хороший инструмент для поиска и исследования репозитория WMI и для интерактивного анализа состояния экземпляров объектов WMI.</p>
<p><strong>Язык запросов WQL</strong></p>
<p>Теперь нам следует разобраться, что же такое WQL, а также каким образом в разделе, где описана работа WMIC, мы делали выборку объектов WMI по определенным критериям. Разбирая эту тему, полезно вспомнить, что объектно-ориентированная модель представления данных хорошо ложится на структуру реляционных баз данных. В частности можно провести следующие аналогии: определение таблицы данных (поля и их типы) – это классы объектов, строки в конкретной таблице – это экземпляры объектов данного класса. Каждое поле (столбец) в таблице – это свойство всех объектов данного класса. Каждая ячейка в конкретной строке – это свойство (property) конкретного экземпляра объекта. Связи таблиц и представления можно рассматривать как частный случай наследования. Триггеры и встроенные процедуры исходя из этой аналогии – это методы классов.</p>
<p>Собственно, для того чтобы удобно было работать с множественными экземплярами объектов WMI, используется язык WMI Query Language (WQL), который является подмножеством ANSI SQL.</p>
<p>Основное отличие WQL от ANSI SQL состоит в том, что WQL не позволяет производить изменения в данных WMI, т. е. фактически в WQL поддерживается лишь один оператор SQL: select. Кроме того, в операторе select языка WQL не поддерживаются следующие ключевые слова: DISTINCT, COUNT, JOIN, SUBSTRING, ORDER BY, UPPER, LOWER и DATEPART (эти ключевые слова поддерживаются в варианте Extended WQL (eWQL), реализованном в Microsoft SMS 2.0 и SMS 2003). Не поддерживаются арифметические операторы. Кроме того конструкции IS и IS NOT могут применяться только в сочетании с константой NULL. Языком WQL поддерживается оператор LIKE. Более подробно про шаблоны, применяемые совместно с оператором LIKE в WQL, можно ознакомиться в оригинальном описании WMI на сайте Microsoft [12, 13].</p>
<p>Ниже приведен пример некоторых типичных WQL-запросов:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #008000; font-weight: bold;">SELECT</span> <span style="color: #666666;">*</span> <span style="color: #008000; font-weight: bold;">FROM</span> Win32_LogicalDisk <span style="color: #008000; font-weight: bold;">WHERE</span> FileSystem <span style="color: #008000; font-weight: bold;">IS</span> <span style="color: #008000; font-weight: bold;">NULL</span>
<span style="color: #008000; font-weight: bold;">SELECT</span> <span style="color: #666666;">*</span> <span style="color: #008000; font-weight: bold;">FROM</span> Win32_LogicalDisk <span style="color: #008000; font-weight: bold;">WHERE</span> FileSystem <span style="color: #008000; font-weight: bold;">IS</span> <span style="color: #008000; font-weight: bold;">NOT</span> <span style="color: #008000; font-weight: bold;">NULL</span>
<span style="color: #008000; font-weight: bold;">SELECT</span> <span style="color: #666666;">*</span> <span style="color: #008000; font-weight: bold;">FROM</span> Win32_LogicalDisk <span style="color: #008000; font-weight: bold;">WHERE</span> FileSystem <span style="color: #666666;">=</span> <span style="color: #19177c;">"NTFS"</span>
<span style="color: #008000; font-weight: bold;">SELECT</span> <span style="color: #666666;">*</span> <span style="color: #008000; font-weight: bold;">FROM</span> Win32_DiskDrive <span style="color: #008000; font-weight: bold;">WHERE</span> Partitions <span style="color: #666666;">&lt;</span> <span style="color: #666666;">2</span> <span style="color: #008000; font-weight: bold;">OR</span> SectorsPerTrack <span style="color: #666666;">&gt;</span> <span style="color: #666666;">100</span>
<span style="color: #008000; font-weight: bold;">SELECT</span> <span style="color: #666666;">*</span> <span style="color: #008000; font-weight: bold;">FROM</span> Win32_LogicalDisk <span style="color: #008000; font-weight: bold;">WHERE</span> (Name <span style="color: #666666;">=</span> <span style="color: #19177c;">"C:"</span> <span style="color: #008000; font-weight: bold;">OR</span> Name <span style="color: #666666;">=</span> <span style="color: #19177c;">"D:"</span>) 
   <span style="color: #008000; font-weight: bold;">AND</span> FreeSpace <span style="color: #666666;">&gt;</span> <span style="color: #666666;">2000000</span> <span style="color: #008000; font-weight: bold;">AND</span> FileSystem <span style="color: #666666;">=</span> <span style="color: #19177c;">"NTFS"</span>
<span style="color: #008000; font-weight: bold;">SELECT</span> <span style="color: #666666;">*</span> <span style="color: #008000; font-weight: bold;">FROM</span> Win32_NTLogEvent <span style="color: #008000; font-weight: bold;">WHERE</span> Logfile <span style="color: #666666;">=</span> <span style="color: #ba2121;">'Application'</span>
<span style="color: #008000; font-weight: bold;">SELECT</span> <span style="color: #666666;">*</span> <span style="color: #008000; font-weight: bold;">FROM</span> Meta_Class <span style="color: #008000; font-weight: bold;">WHERE</span> __Class <span style="color: #008000; font-weight: bold;">LIKE</span> <span style="color: #666666;">%</span>Win32<span style="color: #666666;">%</span>
<span style="color: #008000; font-weight: bold;">SELECT</span> <span style="color: #666666;">*</span> <span style="color: #008000; font-weight: bold;">FROM</span> __InstanceCreationEvent <span style="color: #008000; font-weight: bold;">WHERE</span> TargetInstance ISA <span style="color: #19177c;">"Win32_NTLogEvent"</span>
   <span style="color: #008000; font-weight: bold;">GROUP</span> WITHIN <span style="color: #666666;">600</span> <span style="color: #008000; font-weight: bold;">BY</span> TargetInstance.SourceName <span style="color: #008000; font-weight: bold;">HAVING</span> NumberOfEvents <span style="color: #666666;">&gt;</span> <span style="color: #666666;">25</span>
</pre>
</div>
<p>Вы можете поупражняться в запросах WMI с помощью уже хорошо известной вам утилиты WBEMTEST, нажав кнопку «Query» в ее главном окне.</p>
<p>Теперь вспомните утилиту командной строки WMIC, функции которой мы разбирали немного выше. В ее синтаксисе также могут использоваться WQL-запросы для удобства работы с наборами объектов одного класса. Чтобы использовать уже имеющиеся и проверенные WQL-запросы (большинство из них удобнее всего проверять утилитой WBEMTEST), из командной строки достаточно отбросить у WQL-запроса первую часть: «select * from». Затем заменить имя класса на его алиас (псевдоним) из таблицы 1 и при необходимости добавить после запроса вызов метода, формат вывода списка или запрос свойства объекта. Примеры того, что при этом получается, я уже приводил выше.</p>
<p>Если же среди псевдонимов в таблице 1 нет нужного вам класса, то есть два пути решения. Первый – добавить новый псевдоним для нового класса. Этот путь хорош, если с этим классом из WMIC вы будете работать только на этом компьютере. Если же вы хотите использовать команду wmic на разных компьютерах, в том числе и на тех, на которых такой алиас вы не определяли, то можно воспользоваться вторым способом. Второй способ позволяет явно использовать настоящее имя класса WMI при обращении к нему с помощью WMIC. Для этого используйте следующий синтаксис:</p>
<!-- HTML generated using hilite.me -->
<div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">wmic path Win32_LogicalDisk WHERE FileSystem='NTFS' get /value
</pre>
</div>
<p><strong>Заключение</strong></p>
<p>Во второй части статьи [15] обсудим написание сценариев с использованием WMI и WSH. Будут разобраны особенности использования WMI в скриптах, из тех, которые обычно вызывают наибольшие затруднения у людей, начинающих работать с этой технологией. К таким темам я отношу: построение moniker string, использование различных пространств имен WMI, связка WMI и COM, использование различных языков программирования вместе с WMI, имперсонация, аутентификация и привилегии. Наконец, наиболее интересные моменты, связанные с подключением к удаленным компьютерам и обработкой системных событий с помощью WMI. В заключении мы обсудим готовые продукты, использующие WMI и стратегию развития этой технологии, а так же ее применения в информационных системах предприятий.</p>
<p>[<strong>Ссылки и литература</strong>]</p>
<p><strong>1</strong>. <span style="color: #333399;">Distributed Management Task Force Inc. site:dmtf.org</span>.<br><strong>2</strong>. <span style="color: #333399;">WMICodeCreator.zip site:microsoft.com</span> - WMI Code Creator 1.0.<br><strong>3</strong>. <span style="color: #333399;">WMITools.exe site:microsoft.com</span> - WMI Administrative Tools.<br><strong>4</strong>. <span style="color: #333399;">Scriptomatic site:microsoft.com</span>.<br><strong>5</strong>. <span style="color: #333399;">Tweakomatic Utility site:microsoft.com</span>.<br><strong>6</strong>. <span style="color: #333399;">Microsoft Scripting Downloads Catalog site:msdn.microsoft.com</span>.<br><strong>7</strong>. <span style="color: #333399;">WMI Downloads catalog site:msdn.microsoft.com</span>.<br><strong>8</strong>. <span style="color: #333399;">ADSI Scriptomatic site:microsoft.com</span>.<br><strong>9</strong>. <span style="color: #333399;">WMI Core 1.5 for Windows 9x, NT 4.0 SP4 site:microsoft.com</span>.<br><strong>10</strong>. <span style="color: #333399;">Windows Scripting Host 5.6 for Windows 9x/NT/ME site:microsoft.com</span>.<br><strong>11</strong>. <span style="color: #333399;">Microsoft Windows Script 5.6 Documentation site:microsoft.com</span>.<br><strong>12</strong>. <span style="color: #333399;">WQL Keywords and description site:msdn.microsoft.com</span>.<br><strong>13</strong>. <span style="color: #333399;">Windows Management Instrumentation site:msdn.microsoft.com</span>.<br><strong>14</strong>. <span style="color: #333399;">Вы всё ещё не используете WMI? Часть 1 site:samag.ru</span>.<br><strong>15</strong>.&nbsp;<span style="color: #333399;">Вы всё ещё не используете WMI? Часть 2 site:samag.ru</span>.&nbsp;</p></td>
</tr>

</tbody></table>
<span class="article_separator">&nbsp;</span>


</body></html>